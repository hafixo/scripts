<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>openSUSE Lizards</title>
	<atom:link href="https://lizards.opensuse.org/feed/" rel="self" type="application/rss+xml" />
	<link>https://lizards.opensuse.org</link>
	<description>Blogs and Ramblings of the openSUSE Members</description>
	<lastBuildDate>Tue, 09 Oct 2018 15:09:49 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.7.5</generator>
	<item>
		<title>Highlights of YaST Development Sprint 64</title>
		<link>https://lizards.opensuse.org/2018/10/09/yast-sprint-64/</link>
		<comments>https://lizards.opensuse.org/2018/10/09/yast-sprint-64/#respond</comments>
		<pubDate>Tue, 09 Oct 2018 15:09:06 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Miscellaneous]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[Usability]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13402</guid>
		<description><![CDATA[Another two weeks of development, another report from the YaST team. During this sprint, we have been working to improve the usage and installation experience in many areas, including but not limited to the following. Improvements in several areas of the Partitioner. More informative Snapper. Better integration of the new Firewall UI with AutoYaST. Improvements [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Another two weeks of development, another report from the YaST team. During this sprint, we have been working to improve the usage and installation experience in many areas, including but not limited to the following.</p>
<ul>
<li>Improvements in several areas of the Partitioner.</li>
<li>More informative Snapper.</li>
<li>Better integration of the new Firewall UI with AutoYaST.</li>
<li>Improvements in roles management and in the roles description.</li>
<li>Better support in YaST Firstboot for devices with no hardware clock, like Raspberry Pi.</li>
</ul>
<p>Let&#8217;s dive into the details </p>
<h3>Changes in the Partitioner UI to Unleash the Storage-ng Power</h3>
<p>We have explained already in several previous posts how we were struggling to come up with a set of changes to the user interface of the Partitioner that would allow to expose all the new functionality brought by storage-ng, while still being familiar to our users and fitting in a text console with 80 columns and 24 lines.</p>
<p>We finally implemented the interface described in <a>this gist</a>,  which fits into a 80&#215;24 text console and allows all kind of operations. Check that document for more info about the behavior and its rationale.</p>
<p>But what does &#8220;all kind of operations&#8221; mean? For example, it means it&#8217;s possible to start with three empty disks and end up creating this complex setup using only the Partitioner.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/complex-devicegraph.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/complex-devicegraph-236x300.png" alt="Complex storage setup" width="236" height="300" class="aligncenter size-medium wp-image-13404" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/complex-devicegraph-236x300.png 236w, https://lizards.opensuse.org/wp-content/uploads/2018/10/complex-devicegraph.png 461w" sizes="(max-width: 236px) 100vw, 236px" /></a></p>
<ul>
<li>In that example, <code>/dev/md0</code> is an MD RAID defined on top of two partitions and formatted as &#8220;/&#8221;. Nothing impressive here so far.
<li><code>/dev/md1</code> is an MD RAID defined on top of a combination of full disks and partitions. Using disks as base for a RAID was not possible in the old Partitioner.</li>
<li>Even more, <code>/dev/md1</code> contains partitions like <code>/dev/md1p1</code> and <code>/dev/md1p2</code>, another thing that the old Partitioner didn&#8217;t allow to configure.</li>
<li><code>/dev/volgroup0</code> is an LVM VG based on one of those MD partitions, allowing to combine the best of the MD and LVM technologies in a new way.</li>
<li>Last but not least, <code>/dev/sdc</code> is a disk formatted to host a file-system directly, with no partitions in between (also a new possibility).</li>
</ul>
<p>The general approach of the new UI is described in the linked document. But since an image is worth a thousand words (and an animation is probably worth two thousands), let&#8217;s see how some part of the process to create the complex setup described about would look in a text console.</p>
<p>This is how you can now directly format a disk with no partitions.</p>
<p><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/formatting_a_disk.gif" alt="Formatting a disk" /></p>
<p>Playing with the partitions of a disk is also a good way to get a feeling on how the buttons are now organized and how they dynamically change based on which row is selected in each table. Click on the following image to animate it and see those views in action.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/playing_with_partitions.gif"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/playing_with_partitions-play.png" alt="Playing with partitions" width="300" height="190" class="aligncenter size-medium wp-image-13408" /></a></p>
<p>And for a full experience of completely new stuff. Click on the image below to see an animation showing the whole process of creating an MD RAID on top of two full disks and then creating partitions within the resulting RAID.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/creating_partitioned_array.gif"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/creating_partitioned_array-play.png" alt="Creating a partitioned RAID" width="300" height="190" class="aligncenter size-medium wp-image-13409" /></a></p>
<p>But although the text mode is the limiting factor to design a YaST UI, many users install their systems and use the Partitioner in graphical mode. For those wondering how the reorganized buttons look in that case, here are some screenshots of the installation process of the upcoming SLE-15-SP1 (static screenshots this time, we already had enough animations for one post).</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/raid-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/raid-qt-300x215.png" alt="Managing RAIDs with the new Partitioner UI" width="300" height="215" class="aligncenter size-medium wp-image-13414" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/raid-qt-300x215.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/raid-qt-768x550.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/raid-qt.png 1009w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/partitions-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/partitions-qt-300x214.png" alt="Managing Partitions with the new Partitioner UI" width="300" height="214" class="aligncenter size-medium wp-image-13415" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/partitions-qt-300x214.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/partitions-qt-768x547.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/partitions-qt.png 1008w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Displaying Bcache Devices Consistently in the Device Graphs</h3>
<p>Surely most Partitioner users have recognized the style of the visual representation used above for the complex example setup. As you know, the Partitioner offers similar representations in the &#8220;Device Graphs&#8221; section, both for the original layout of the system and for the target one.</p>
<p>After adding support for Bcache to the Partitioner we detected a small but annoying problem in those graphs. The caching devices were using their UUID as labels, which had two drawbacks.</p>
<ul>
<li>It was too long.</li>
<li>It&#8217;s not known in advance for &#8220;planned&#8221; cache sets (i.e. sets that will be created after going forward in the Partitioner), which resulted in boxes with no labels</li>
</ul>
<p>So know we use a fixed &#8220;bcache cache&#8221; label for all cache sets, which looks like this.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/cset-label.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/cset-label-300x221.png" alt="New label for cache sets in the Device Graph" width="300" height="221" class="aligncenter size-medium wp-image-13416" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-label-300x221.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-label-768x565.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-label-1024x753.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-label.png 1027w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>As opposed to the old way with empty boxes.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label-300x222.png" alt="Lack of labels in the old Device Graphs" width="300" height="222" class="aligncenter size-medium wp-image-13417" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label-300x222.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label-768x567.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label-1024x756.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/10/cset-no-label.png 1029w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Adding and removing Bcache devices</h3>
<p>And since we mention the Bcache support in the Partitioner, it&#8217;s worth noticing that the implementation continues moving forward at good pace. During this sprint we implemented a first version of the operations to add a new Bcache device and to delete it.</p>
<p>When adding a new device, the only options that can currently be defined is which devices to use to construct it. But the next sprint has started and you can expect more options to be supported in the near future.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache-300x220.png" alt="Creating a new Bcache device" width="300" height="220" class="aligncenter size-medium wp-image-13418" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache-300x220.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache-768x564.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache-1024x752.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/10/create-bcache.png 1030w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>When the Bcache device is created, then it can be formatted, mounted or partitioned with the same level of flexibility than other devices in the system. So soon (after the usual integration and automated testing phases) Tumbleweed users will be able to use the YaST Partitioner to test this exciting technology.</p>
<p>Of course the operation to delete a Bcache device offers the usual checks and information available in other parts of the Partitioner, like shown in the following screenshot.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/delete-bcache.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/delete-bcache-300x221.png" alt="Deleting a bcache device" width="300" height="221" class="aligncenter size-medium wp-image-13419" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/delete-bcache-300x221.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/delete-bcache-768x565.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/delete-bcache.png 1022w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Both screenshots are taken with an updated version of the installer of the upcoming SLE-15-SP1, since this functionality will be available in such distribution and, of course, also in openSUSE Leap 15.1.</p>
<h3>Snapper: Show Used Space for each Snapshot</h3>
<p>As those following our blog already know, the YaST Team is also somehow responsible for the development and maintenance of Snapper, the ultimate file-system snapshot tool for Linux. And Snapper has also received some usability improvements during this sprint.</p>
<p>For systems with btrfs and quota enabled, the output of &#8220;snapper list&#8221; now shows the used space for each snapshot. The used space in this case is the exclusive space of the btrfs quota group corresponding to the snapshot.</p>
<pre>
# snapper --iso list
Type   | # | Pre # | Date                | User | Used Space | Cleanup | Description      | Userdata     
-------+---+-------+---------------------+------+------------+---------+------------------+--------------
single | 0 |       |                     | root |            |         | current          |              
single | 1 |       | 2018-10-04 21:00:11 | root | 15.77 MiB  |         | first filesystem |              
single | 2 |       | 2018-10-04 21:19:47 | root | 13.78 MiB  | number  | after install    | important=yes
</pre>
<p>For more details about this change, its advantages and limitations, check the <a href="http://snapper.io/2018/10/04/used-space.html">new post at the Snapper blog</a>.</p>
<h3>Simplified Role Selection</h3>
<p>The role selection dialog in SLE-15 is always displayed in the installation workflow. However, it does not make much sense to display it if there is only one role to select. When you do not register the system and do not use any additional installation repository then in the default SLES-15 installation you can see only the <i>minimal</i> system role.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/10/one-role.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/one-role-300x225.png" alt="Selecting one out of one roles" width="300" height="225" class="aligncenter size-medium wp-image-13435" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/10/one-role-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/10/one-role-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/10/one-role.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>In such case you cannot actually change anything as the only role is pre-selected by default and the only thing which you can do is to press the <i>Next</i> button.</p>
<p>Therefore we improved in for SLE15-SP1, if there is only one role to select then the role is selected automatically and the dialog is skipped.</p>
<p>In addition to that, many of the role descriptions have been adapted and simplified to, hopefully, be more clear.</p>
<h3>YaST Firstboot in devices with no hardware clock</h3>
<p>SLE and openSUSE can be installed on a great variety of devices, including some system that doesn&#8217;t include a hardware Real Time Clock, like the popular Raspberry Pi. That means the usual mechanism to establish the current date and time (using the <code>hwclock</code> command) fails in such devices. That general problem was detected during the usage of YaST Firstboot to configure new devices.</p>
<p>So now YaST detects situations in which there is no Real Time Clock and uses the <code>date</code> as an alternative to set the date and time. This fix, already submitted to openSUSE Tumbleweed, will be available in all upcoming versions of SLE (like SLE-12-SP4 and SLE-15-SP1) and openSUSE Leap.</p>
<h3>Better integration of the new Firewall UI with AutoYaST</h3>
<p>On the <a href="https://lizards.opensuse.org/2018/10/01/yast-sprint-63/">previous report</a> we anticipated the new UI we are building for configuring Firewalld from YaST. During this sprint we have been focusing on some aspects that need to be finished before we can release this new functionality.</p>
<p>Now this UI can be invoked from the AutoYaST module in YaST, meaning it can be used to import and then fine tune the current configuration of the system so it can be exported to an AutoYaST profile.</p>
<p>And since we are already in animation mood, check how the new UI can be used to define an AutoYaST profile.</p>
<p><img src="//lizards.opensuse.org/wp-content/uploads/2018/10/firewall_ay_config.gif" alt="Using the Firewalld UI from the AutoYaST module" /></p>
<p>Very soon the whole functionality will be ready for prime time and we will release it together with a separate blog post to explain all the details.</p>
<h3>Stay tuned</h3>
<p>We are already working on the next sprint, with special focus on AutoYaST, on Snapper and on improving the installation experience in several scenarios. As mentioned above, it&#8217;s likely that you will get more news from us (about the new Firewalld support) even before that sprint is finished.</p>
<p>But if you can&#8217;t wait for more news, don&#8217;t hesitate to visit us on our Irc #yast channel on Freenode. Otherwise, see you here again soon.</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/10/09/yast-sprint-64/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>YaST Squad Sprint 63</title>
		<link>https://lizards.opensuse.org/2018/10/01/yast-sprint-63/</link>
		<comments>https://lizards.opensuse.org/2018/10/01/yast-sprint-63/#comments</comments>
		<pubDate>Mon, 01 Oct 2018 20:13:39 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Factory]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13381</guid>
		<description><![CDATA[Another YaST sprint is over and it is our pleasure to offer a report which includes a wide ranging of topics: The partitioner continues getting more love and attention: now you can partition your RAID devices and we have started to work on supporting Bcache. A new YaST2 firewall UI is around the corner. The [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Another YaST sprint is over and it is our pleasure to offer a report which includes a wide ranging of topics:</p>
<ul>
<li>The partitioner continues getting more love and attention: now you can partition your RAID devices and we have started to work on supporting Bcache.</li>
<li>A new YaST2 firewall UI is around the corner.</li>
<li>The self-update feature has been extended to cover more cases.</li>
<li>YaST supports now your brand new 4K display during installation.</li>
</ul>
<p>And, of course, some bugfixes (like proper handling of problems when trying to deactivate a DASD channel) and infrastructure improvements (check out our take on Travis caching).</p>
<h3>Managing partitions within MD RAID devices</h3>
<p>Our beloved Partitioner was one of the stars of the <a href="https://lizards.opensuse.org/2018/09/12/yast-squad-sprint-62/">previous report</a>, with news about several improvements and refinements. During this sprint it also received some love, not only with the addition of a couple of new features but also with more discussions and prototypes about the reorganization of the UI needed to bring even more improvements.</p>
<p>One of those features introduced in the previous sprint was the ability to create a RAID based on whole disks with no partitions. Now we have closed the circle by allowing to manage partitions within a RAID. So now it&#8217;s possible to create RAID arrays based on any combination of disks and partitions and then either use those arrays directly to host a file system (or to act as LVM physical volume) or create partitions inside the array. Partitions that can be, of course, formatted, encrypted, used as LVM physical volumes, etc. With that, we can now say the Partitioner support every possible MD RAID setup.</p>
<p>In the following animated screenshot you can see how the partitions of an MD RAID are listed in the left-hand tree of the Partitioner and in the table of devices of the RAID section, similar to how partitions of a hard disk are displayed.</p>
<p><img src="//lizards.opensuse.org/wp-content/uploads/2018/09/partitioned_raids.gif" /></p>
<p>As you may have noticed, the main difference with other views is that, as already anticipated by the UI discussions summarized in our previous sprint report, the set of buttons adapts dynamically to the selected item on the table offering a different set of actions for MD arrays and for partitions.</p>
<h3>Another step to define the future of the Partitioner user interface</h3>
<p>The interface showed in the previous screenshot, with its dynamic behavior, is just the first step in the direction already defined in <a href="https://github.com/yast/yast-storage-ng/blob/master/doc/sle15_features_in_partitioner.md">the document</a> that resulted from the previous sprint. Having that first fully functional prototype enabled us to rekindle the discussion about the best way to offer all the new possibilities of storage-ng in the Partitioner while keeping the user interface recognizable and familiar to the YaST users.</p>
<p>After another round of discussions and several iterations of mock-ups, we ended up with the idea documented <a href="https://gist.github.com/ancorgs/25eb67a90b666ec2211ca34034df8771">at this gist</a>. That will be the guide for the UI changes we are already implementing as part of the next sprint as a way to unleash even more of the underlying power of storage-ng.</p>
<h3>Initial support for Bcache in the Partitioner</h3>
<p>But apart from revamping and improving the support for existing technologies with new possibilities, we also want the Partitioner to grow in scope, putting the new kernel technologies into the hands of our users. One of such technologies is Bcache.</p>
<p>Bcache allows to improve the performance of any big but relative slow storage device (so-called &#8220;backing device&#8221; in Bcache terminology) by using a faster and smaller device (so-called caching device) to speed up read and write operations. The resulting Bcache device has then the size of the backing device and (almost) the effective speed of the caching one.</p>
<p>As a first step to offer full Bcache support, the Partitioner can visualize all the Bcache devices and allows to manipulate its partitions. Broader support, like creating new Bcache devices, will follow in upcoming sprints.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/bcache.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/09/bcache-300x220.png" alt="Initial Bcache support in the Partitioner" width="300" height="220" class="aligncenter size-medium wp-image-13387" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/bcache-300x220.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/bcache-768x562.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/bcache-1024x749.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/09/bcache.png 1029w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="new-yast-firewall-ui">A New YaST2 Firewall UI is Coming</h3>
<p><a href="http://firewalld.org">firewalld</a> replaced the venerable <a href="https://en.opensuse.org/SuSEfirewall2">SuSEfirewall2</a> as the default firewall solution in SUSE Linux Enterprise 15 and openSUSE Leap 15.0. And there is high chance that you have noticed that YaST does not offer a user interface to manage the firewall configuration anymore. Instead, it asks the user to use <em>firewall-config</em>, the official <em>firewalld</em> UI.</p>
<p>But, fortunately, that&#8217;s about to change. During recent sprints we have been working in a new UI to manage firewalld configuration. It is still a work in progress, but it is capable of assigning interfaces to zones and opening services/ports for a given zone.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/yast2-firewall-allowed-services.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/09/yast2-firewall-allowed-services-300x239.png" alt="Allowed services in a firewall&#039;s zone" width="300" height="239" class="aligncenter size-medium wp-image-13371" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/yast2-firewall-allowed-services-300x239.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/yast2-firewall-allowed-services-768x612.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/yast2-firewall-allowed-services.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>We plan to release a first version as soon as we finish the integration with the AutoYaST user interface. So stay tunned!</p>
<h3 id="better-hidpi-support">Better HiDPI (4k Display) Support</h3>
<p>What is better than a high screen resolution? Simple: a higher screen resolution. 4k displays are arriving in the consumer mainstream, and 8k displays are the next big thing.</p>
<p>But there are some real-world problems with that: with that large resolution, texts and graphics may become tiny &#8211; too tiny to read, too small to fill the available space on the screen.</p>
<p>On your desktop, you can tweak those things &#8211; select larger fonts or larger icon sizes. But for the installer that&#8217;s another matter; it needs to autodetect the presence of such a display and then auto-scale the user interface so it is actually usable.</p>
<p>We had a number of such issues in YaST; one was the font size, another the size of pixel graphics such as the time zone selection map. Those are now fixed.</p>
<p>For backwards compatibility, the Qt library which we are using for the graphical UI of YaST does not do that completely automatically but we needed to explicitly enable a HiDPI mode. But now it does it all automagically for YaST.</p>
<h3 id="self-update-temporary-repository">Updating Additional Installation Data</h3>
<p>As you may know, YaST is able to update itself during system installation, which enables us to fix the installer by releasing updated packages even after the official release.</p>
<p>However, sometimes we need to fix packages which are not part of the installer but they provide some additional data for it like installation defaults, system role definitions, etc.</p>
<p>In order to support those scenarios, we have extended the installer to use the self-update repository as a regular (but temporary) one during the installation process. So with the next SUSE Linux Enterprise release we will be able to update that data too.</p>
<h3 id="fixing-dasd-channel-deactivation">Fixing DASD Channel Deactivation Support</h3>
<p>Recently we discovered that YaST was getting frozen in s390 architecture when the user tried to deactivate a DASD channel in use. The problem was that <em>dasd_configure</em>, the underlying tool which takes care of deactivating the channel, was waiting for user confirmation.</p>
<p>Definitely, losing user data is not an option so, from now on, the operation will be just canceled and YaST will report the problem, including all the details, so the user can solve the issue before trying to deactivate the channel again.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/dasd-deactivation-details.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/09/dasd-deactivation-details-300x245.png" alt="DASD deactivation details" width="300" height="245" class="aligncenter size-medium wp-image-13390" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/dasd-deactivation-details-300x245.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/dasd-deactivation-details.png 323w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="travis-ccache">Faster Travis Rebuilds using ccache</h3>
<p>For continuous integration at GitHub we use Travis which is easy to configure and use. Unfortunately, building there a big project like <a href="https://github.com/openSUSE/libstorage-ng">libstorage-ng</a> takes a lot of time. In this case it is almost half an hour. </p>
<p>Waiting so long to see the result after doing a small change in the code is quite annoying and unconvenient. And this is exactly the scenario where using the <a href="https://ccache.samba.org">ccache</a> tool helps a lot. ccache is a small wrapper around the standard C/C++ compiler which saves the compilation result for later. So if the same file is compiled later again then the cached result is returned immediately without calling the real compiler.</p>
<p>Together with the <a href="https://docs.travis-ci.com/user/caching/">Travis caching mechanism</a>, which we use for storing and restoring the ccache files for each build, we reached a significant speed up. From 29 minutes to about 6 minutes, that is about <strong>four times faster</strong>!</p>
<p>Of course, it highly depends how much the environment (compiler, libraries) or the source files have been changed since the last build. The bigger changes the more recompilation is needed, so in reality the speedup might be smaller.</p>
<p>Check <a href="https://github.com/openSUSE/libstorage-ng/pull/575">the related pull request</a> if you are interested in the implementation details.</p>
<h3 id="more-to-come">More to come</h3>
<p>The following sprint is already running and the team is working in really interesting stuff: finishing the bcache support, releasing a first version of the new firewall UI, proper support to use a whole disk as an LVM PV in AutoYaST, several improvements to the installer for CaaSP/Kubic, etc.</p>
<p>So stay tunned!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/10/01/yast-sprint-63/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>YaST Squad Sprint 62</title>
		<link>https://lizards.opensuse.org/2018/09/12/yast-squad-sprint-62/</link>
		<comments>https://lizards.opensuse.org/2018/09/12/yast-squad-sprint-62/#comments</comments>
		<pubDate>Wed, 12 Sep 2018 14:11:31 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Factory]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>
		<category><![CDATA[github]]></category>
		<category><![CDATA[jenkins]]></category>
		<category><![CDATA[storage]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13344</guid>
		<description><![CDATA[Jenkins commenting in GitHub pull requests Intel Rapid Start Technology for better sleeping Consistent storage proposal in SLE-12 Partitioner: designing the UI for its full potential Partitioner: entire disks as members of a software MD RAID Partitioner: better explanation of unusual conditions A sample of bug fixes Improved Jenkins Integration It happened quite often that [&#8230;]]]></description>
				<content:encoded><![CDATA[<ul>
<li>Jenkins commenting in GitHub pull requests</li>
<li>Intel Rapid Start Technology for better sleeping</li>
<li>Consistent storage proposal in SLE-12</li>
<li>Partitioner: designing the UI for its full potential</li>
<li>Partitioner: entire disks as members of a software MD RAID</li>
<li>Partitioner: better explanation of unusual conditions</li>
<li>A sample of bug fixes</li>
</ul>
<h3 id="improved-jenkins-integration">Improved Jenkins Integration</h3>
<p>It happened quite often that our <a href="https://ci.opensuse.org/view/Yast/">Jenkins</a> job failed for some reason after merging a pull request at GitHub. And because the Jenkins is supposed to submit the changes to the build service it happened that the fixes from Git were not released in the RPM packages if nobody noticed the failure. That was a bit confusing because we closed a bug at Bugzilla but the fix was not available anywhere.</p>
<p>To avoid this we have added a wrapper script which runs the original Jenkins command (<code>rake osc:sr</code> in this case) and writes the result as a comment to the respective pull request at GitHub. If a submit request is created it additionally adds a link to it.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-1-jenkins.png"><img class="aligncenter size-medium wp-image-13356" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-1-jenkins-300x226.png" alt="" width="300" height="226" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-1-jenkins-300x226.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-1-jenkins.png 418w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>Since now you should keep the pull request page open after merging it and wait for the Jenkins status result. If it fails for some reason then try fixing it or ask for help on IRC or the YaST mailing list.</p>
<p>Note: This automation works only for the code branches which are in active development and for packages which have an Jenkins job assigned (most of the YaST packages have).</p>
<h3 id="intel-rapid-start-technology-support">Intel Rapid Start Technology Support</h3>
<p>The <a href="https://software.intel.com/en-us/articles/what-is-intel-rapid-start-technology">Intel Rapid Start Technology</a> allows to use a fast disk (SSD) for suspend-to-RAM to save energy. The idea is that after a given time the contents of RAM will be moved to SSD so that the system can power itself off. When powered on, RAM will be read back. So it&#8217;s something like a dynamic changing of suspend-to-RAM to suspend-to-fast-disk.</p>
<p>What does this technology need from the installer? It needs its own dedicated partition where it can store the contents of RAM. To support this technology we added in this sprint the ability to create and recognize such a partition. It looks like this:<br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1.png"><img class="aligncenter size-medium wp-image-13355" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1-300x220.png" alt="" width="300" height="220" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1-300x220.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1-768x562.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1-1024x750.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-2-irst1.png 1052w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2.png"><img class="aligncenter size-medium wp-image-13354" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2-300x220.png" alt="" width="300" height="220" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2-300x220.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2-768x564.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2-1024x752.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-3-irst2.png 1035w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="consistent-storage-proposal-sle-12-sp4-yast2-storage-old">Consistent Storage Proposal (SLE-12-SP4 / yast2-storage-old)</h3>
<p>We fixed a bug where the behavior was inconsistent if you switched the storage proposal between partition-based and LVM-based / encrypted LVM-based: <a href="https://bugzilla.suse.com/show_bug.cgi?id=1085169">bsc#1085169</a>.</p>
<p>The behavior was pretty irritating: Initially, it would propose to create a separate &#8220;/home&#8221; partition, but when you changed the proposal parameters and simply kept that checkbox <em>&#8220;[x] separate /home&#8221;</em> checked, it would complain that with the current settings a separate &#8220;/home&#8221; was not possible.</p>
<p>The two code paths did the calculations differently: One accounted for the other partitions that were also proposed like &#8220;swap&#8221; and &#8220;boot&#8221; (or &#8220;PrEP&#8221; or &#8220;/efi-boot&#8221;), the other did not. We unified that as much as reasonably possible without breaking things, but since calculating when and how to use any boot partitions is quite complex in that <del>old</del> legacy storage stack, we did not go all the way; boot partitions are pretty small, so their size matters only in very pathological fringe cases. We try not to overengineer things, in particular not with the 4th service pack for a business product.</p>
<p>More details in the <a href="https://github.com/yast/yast-storage/pull/301">pull request with the fix</a>.</p>
<h3 id="the-partitioner-looks-to-the-future">The Partitioner looks to the future</h3>
<p>We have blogged a lot about Storage-NG and the possibilities and features it will bring to the users. But a significant part of its power remain dormant under the surface because we decided to clone the user interface and the functionality of the classical YaST Partitioner for the deadline marked by SLE 15 (and Leap 15.0). But now we are finally able to start exposing those long-awaited features and to bring new ones for the current Tumbleweed and for the future SLE-15-SP1 and Leap 15.1.</p>
<p>The user interface of the Partitioner is already rather packed with functionality, but we want to avoid a too disruptive redesign. So it was time to some pen and paper sessions, trying to find and draw a good way to add exciting new stuff to the Partitioner, including all of the following:</p>
<ul>
<li>Allow entire disks (no partition table) to be added as members of a software MD RAID.</li>
<li>Manage (create, modify and delete) partitions within a software MD RAID device.</li>
<li>Make possible to format an entire disk (no partition table) and/or define a mount point for it (just as we do with partitions or LVM logical volumes).</li>
<li>Manage <a href="https://bcache.evilpiepirate.org/">Bcache</a> so the user can set and configure which devices will be used to speed up others.</li>
</ul>
<p>As usual, we consulted some UI experts in the process and the result is this <a href="https://github.com/yast/yast-storage-ng/blob/master/doc/sle15_features_in_partitioner.md">first version of a document</a>, which summarizes how to incorporate all that to the Partitioner, including some alternatives we are considering for the near future.</p>
<p>That document will become the cornerstone of future developments. Sometimes you need to spend a sprint doing other stuff (like researching and documenting) before you can go ahead with writing code.</p>
<h3 id="partitioner-full-disks-as-members-of-a-software-md-raid">Partitioner: full disks as members of a software MD RAID</h3>
<p>The first of the features described in the previous document is already available for Tumbleweed users (or it will be as soon as the integration process concludes) and, thus, ready for the upcoming releases of SLE and Leap. Now the Partitioner offers full disks as &#8220;Available Devices&#8221; in the RAID screen, following the criteria and considerations explained at the document.</p>
<p>That brings even more ways of combining devices together (disks, partitions, software RAIDs, you name it) to create a storage setup. As a result, we decided it was important to explain the situation when some combinations are not possible right away, likely because they need some previous step. Which brings us to&#8230;</p>
<h3 id="partitioner-more-specific-errors-when-a-device-is-in-use">Partitioner: more specific errors when a device is in use</h3>
<p>In general, most of the checks already present in the Partitioner were already able to correctly handle situations in which the disk was a direct member of an MD RAID or an LVM volume group. But the message about the device being in use was not informative enough.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-4-part-err1.png"><img class="aligncenter size-medium wp-image-13353" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-4-part-err1-300x140.png" alt="" width="300" height="140" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-4-part-err1-300x140.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-4-part-err1.png 321w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>Now the message includes the name of the device that is making the operation impossible (it&#8217;s usually one, but there are corner cases in which it can be more than one), so the user has some clue about how to fix it.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-7-part.png"><img class="aligncenter size-medium wp-image-13350" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-7-part-300x170.png" alt="" width="300" height="170" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-7-part-300x170.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-7-part.png 618w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<h3 id="partitioner-improved-creation-of-partition-table">Partitioner: improved creation of partition table</h3>
<p>One part of the Partitioner that was specially bad at explaining the current situation and the possible consequences was the workflow of &#8220;Create New Partition Table&#8221;, which also used to exhibit a behavior quite inconsistent with the rest of the Partitioner actions.</p>
<p>In SLE-15 and openSUSE Leap 15.0, the &#8220;Create New Partition Table&#8221; button immediately presents a form to select the partition table type in case the device supports more than one.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-6-part.png"><img class="aligncenter size-medium wp-image-13351" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-6-part-300x188.png" alt="" width="300" height="188" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-6-part-300x188.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-6-part.png 615w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>And <strong>after</strong> the user selects one type it <strong>always</strong> shows a warning about all kind of devices to be destroyed, no matter if some device is really affected or not.</p>
<div class="figure"></div>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-5-part-err2.png"><img class="aligncenter size-full wp-image-13352" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-5-part-err2.png" alt="" width="279" height="169" /></a></p>
<p>Even better, if only one partition table type is possible, it still shows the form but with no question. So creating a partition table in a completely empty DASD device result in a misleading warning (nothing is going to be destroyed) on top of an empty wizard.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-8-part.png"><img class="aligncenter size-medium wp-image-13349" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-8-part-300x178.png" alt="" width="300" height="178" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-8-part-300x178.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-8-part.png 627w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>So the whole action was reimplemented to display the warning only if some devices are indeed going to be affected (including the list of affected devices) and to display that warning as soon as the user clicks the button (as any other Partitioner action).</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-9-part-good.png"><img class="aligncenter size-medium wp-image-13348" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-9-part-good-300x206.png" alt="" width="300" height="206" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-9-part-good-300x206.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-9-part-good-768x528.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-9-part-good.png 781w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>As seen in the screenshot, the check handles correctly situations in which the disk as a whole (no partitions) is part of an MD RAID or an LVM setup. And, of course, there are no empty wizard steps in the case of DASD or nothing like that. Now the workflow works in the expected way on each situation.</p>
<p>In short, the Storage-NG Partitioner is moving away, step by step, from being a 1:1 clone of the historical Partitioner to offer more functionality and usability. And there are more improvements to come in that area.</p>
<h3 id="partitioner-unmounting-devices-in-advance">Partitioner: Unmounting devices in advance</h3>
<p>The Partitioner allows to extensively configure your system storage devices. You can perform a lot of different kind of actions, from changing the label of a file system to creating a complex configuration by using LVM or RAIDs. Each modification you perform is stored in memory, so the real system is not altered at all until you confirm to apply the changes as last step. But in some circumstances, the Partitioner could not be able to perform some of the required actions, and it would fail when trying to modify the real system. One action that sometimes might fail is unmounting a device. This action might fail for several reasons, but the most common is because the file system is busy. And moreover, sometimes there are actions that require the device to be unmounted, for example, for deleting a partition, so the Partitioner would try to automatically unmount it.</p>
<p>During this sprint, the Partitioner has recovered its ability of unmounting devices on the fly to avoid possible failures when applying the changes. Now, if you want to delete a currently mounted device (e.g., a LVM Logical Volume) you will be asked in advance to unmount it. If you accept, the Partitioner will try to unmount the device on the fly without waiting to apply all the changes. In case the unmount action fails, you will be informed about the problem and you might try to manually solve the problem before the Partitioner applies the changes in your system. Of course, you can also continue without unmounting the device and the Partitioner will try to automatically unmount it after accepting all the changes.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-91-umount.png"><img class="aligncenter size-medium wp-image-13347" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-91-umount-300x225.png" alt="" width="300" height="225" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-91-umount-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-91-umount-768x575.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-91-umount.png 869w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-92-umount.png"><img class="aligncenter size-medium wp-image-13346" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-92-umount-300x225.png" alt="" width="300" height="225" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-92-umount-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-92-umount-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-92-umount.png 870w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<p>Another task that might require unmounting the device is resizing the filesystem. The Partitioner will ask you about unmounting the device when the filesystem does not support resizing while being mounted. And, even when the filesystem does support it, you still might be requested to unmount the device. For example when you want to extend a device by more than 50 GiB. That task might be quite slow and it is highly recommended to unmount the device to speed up the resizing time, otherwise it could take hours.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-93-grow.png"><img class="aligncenter size-medium wp-image-13345" src="//lizards.opensuse.org/wp-content/uploads/2018/09/s62-93-grow-300x225.png" alt="" width="300" height="225" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-93-grow-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-93-grow-768x575.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/09/s62-93-grow.png 868w" sizes="(max-width: 300px) 100vw, 300px" /></a></div>
<h3 id="bug-fixes">Bug Fixes</h3>
<p>Of course, we continue fighting against bugs. Thus, from this sprint on, alongside other minor stuff, the system</p>
<ul>
<li><a href="https://github.com/yast/yast-ntp-client/pull/116">obeys the user and does not keep running the chrony service</a> when they uncheck the &#8220;Run NTP as daemon&#8221; option in the timezone dialog.</li>
<li><a href="https://github.com/yast/yast-journal/pull/34">does not crash when the user has no access to the journal logs</a>, displaying a human-readable message, even with a hint!</li>
<li><a href="https://github.com/yast/yast-installation/pull/738">copies the correct metadata file</a> during the installation, and</li>
<li><a href="https://github.com/yast/yast-registration/pull/398">limits the size of the registration code</a>, to avoid showing you an ugly and unintelligible error in case of you write there a long paragraph instead ;-P</li>
</ul>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/09/12/yast-squad-sprint-62/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>YaST Squad Sprint 61</title>
		<link>https://lizards.opensuse.org/2018/08/29/yast-sprint-61/</link>
		<comments>https://lizards.opensuse.org/2018/08/29/yast-sprint-61/#comments</comments>
		<pubDate>Wed, 29 Aug 2018 08:53:18 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Miscellaneous]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13325</guid>
		<description><![CDATA[We have to admit that lately we have not been exactly regular and reliable in delivering our blog posts. But with the vacation season coming to an end, we are determined to recover the good pace. Since the proof is in the pudding, here is our latest report, just one week after the previous one. [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>We have to admit that lately we have not been exactly regular and reliable in delivering our blog posts. But with the vacation season coming to an end, we are determined to recover the good pace. Since the proof is in the pudding, here is our latest report, just one week after the previous one.</p>
<h3>Improving the user experience in the Services Manager</h3>
<p>And talking about <a href="https://lizards.opensuse.org/2018/08/22/yast-squad-sprint-59-60/">the previous report</a>, we presented there several improvements in the YaST Services Manager module, including the new &#8220;Apply&#8221; and &#8220;Show Log&#8221; buttons. With the &#8220;Apply&#8221; button, all changes performed over the services are applied without closing the Services Manager, which allows you to continue using it and to inspect the logs of a service without relaunching the Services Manager again. But this new &#8220;Apply&#8221; button only makes sense when there is something to save, so during this sprint we have improved the UI to disable the button when nothing has been changed yet. In addition, now it is easier to know what we have edited so far in the Services Manager. For every change over a service, the new value is explicitly highlighted by using the special mark <code>(*)</code>. For example, when you change the start mode of a service from &#8220;On boot&#8221; to &#8220;On demand&#8221;, you will see &#8220;<code>(*) On Demand</code>&#8221; in the corresponding column, see example.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/services-mark.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/services-mark-300x224.png" alt="https://lizards.opensuse.org/2018/08/22/yast-squad-sprint-59-60/" width="300" height="224" class="aligncenter size-medium wp-image-13327" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/services-mark-300x224.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-mark-768x573.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-mark.png 871w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The list of services and the changes performed on them can be quite long. So in addition to the new mark, now a confirmation popup is shown up when using the &#8220;Apply&#8221; or &#8220;OK&#8221; button. This popup will present a summary with all changes that will be applied, that is, what services will be started or stopped, what services will change its start mode to &#8220;on boot&#8221;, &#8220;on demand&#8221; or &#8220;manually&#8221;, and even which will be the new default Systemd Target in case you have modified it. See an example in the following screenshot.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/services-popup.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/services-popup-300x224.png" alt="New summary of changes in the Services Manager" width="300" height="224" class="aligncenter size-medium wp-image-13328" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/services-popup-300x224.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-popup-768x572.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-popup.png 871w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>These improvements will reach openSUSE Tumbleweed soon and will be available in the upcoming versions of SLE (SLE-15-SP1) and openSUSE Leap (15.1).</p>
<h3>Yast2 Systemd classes reorganized</h3>
<p>Related to the changes in the Service Manager and in a more developer-oriented note. Yast2 Systemd (the set of YaST components that handle Systemd units under the hood) also has been completely reorganized in a more Ruby compliant way. Moving from YCP-style modules to a set of classes that behave like nice citizens of the Ruby ecosystem in their own proper namespace.</p>
<h3>AutoYaST support for Xen virtual partitions</h3>
<p>And to continue with refinements over the features introduced in the previous sprint, we have also improved the support for the so-called Xen virtual partitions that we presented in our previous post. As explained there, the old storage stack used to represent the Xen devices like <code>/dev/xvda1</code> as partitions of a non-existing <code>/dev/xvda</code> hard disk. In the new stack, those devices are treated as they deserve, as independent block devices on themselves with no made-up disks coming from nowhere.</p>
<p>But AutoYaST profiles from a SLE-12 or Leap 42.x still pretend there are hard disks grouping the Xen virtual partitions. So in addition to the fixes introduced in the Partitioner during the previous sprint, we also had to teach the new storage stack how to handle fanciful AutoYaST <code>&lt;drive&gt;</code> sections like this, used to describe groups of Xen devices (<code>xvda1</code> and <code>xvda2</code> really exist in the system, <code>xvda</code> doesn&#8217;t).</p>
<pre>
 &lt;drive&gt;
    &lt;device&gt;/dev/xvda&lt;/device&gt;

    &lt;partition&gt;
      &lt;partition_nr&gt;1&lt;/partition_nr&gt;
      ...information about /dev/xvda1...
    &lt;/partition&gt;

    &lt;partition&gt;
      &lt;partition_nr&gt;2&lt;/partition_nr&gt;
      ...information about /dev/xvda2...
    &lt;/partition&gt;

  &lt;/drive&gt;
&lt;/pre&gt;
</pre>
<p>The fix will be released as an installer self-update patch so users installing SLE-15 (with access to a self-update repository) can take advantage of it. In the mid term we will have to come up with a more realistic format to represent such devices in the AutoYaST profiles, but so far the limitations of the current AutoYaST format enforces us to keep the current approach.</p>
<h3>Ignoring inactive RAID arrays</h3>
<p>But that&#8217;s not the only new skill of Storage-ng for this sprint. It also learned how to better manage inactive RAID arrays. MD RAID arrays are built to handle failures of the underlying physical devices. When some of the devices fail, the RAID becomes &#8220;degraded&#8221; which means the data is still accessible but it&#8217;s time to fix things. When too many devices suffer a fault, the RAID becomes inactive and it cannot operate any longer until it&#8217;s repaired. Our Partitioner was not handling this situation well, popping up a generic &#8220;unexpected situation&#8221; error message.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/unexpected-error.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/unexpected-error.png" alt="Generic error message in Storage-ng" width="298" height="193" class="aligncenter size-full wp-image-13332" /></a></p>
<p>We have fixed that, and the storage stack doesn&#8217;t go nuts any longer if an inactive RAID array is found. Even more, it now shows an &#8220;Active: Yes/No&#8221; field under the RAID heading to inform the user in case the RAID is in such bad shape.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/inactive-raid.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/inactive-raid-300x225.png" alt="Partitioner displaying an inactive RAID array" width="300" height="225" class="aligncenter size-medium wp-image-13334" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/inactive-raid-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/inactive-raid-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/inactive-raid.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>All that will be soon available as a maintenance update for SLE-15 and Leap 15.0. So far, no mechanisms have been introduced to stop the user from modifying an inactive RAID array with the Partitioner. That will come in the future, together with other MD RAID improvements in Storage-ng targeting future releases of SLE and openSUSE Leap.</p>
<h3>Media support in the Installation Server module</h3>
<p>It&#8217;s quite embarrassing but it turned out that the Installation Server YaST module in SLE15 and openSUSE Leap 15.0 is not able to add the SLE15/Leap15 installation media. The reason is that the new media use a different repository format and the Installation Server module crashed when trying to add a new repository.</p>
<p>Fortunately the fix was small and allows adding the new media correctly. We plan to release a maintenance update for SLE15, openSUSE Leap 15.0 and SLE12-SP3. It turned out that the code in SLE11-SP4 is more robust and does not crash so we do not need an update there.</p>
<h3>Improved help text for system roles</h3>
<p>We recently got a bug report about how hard was to read the help text in the installation screen explaining the system roles. So we took it as an opportunity to try how flexible our help text system is. Adding some richtext format made it look much better in graphical mode and also surprisingly well text mode. Let&#8217;s see some screenshots from Leap 15.0, although the fix applies to as well to openSUSE Tumbleweed and the SLE15 family.</p>
<p>This is how it looked before the fix.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-prefix.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-prefix-300x226.png" alt="The poorly formatted help of the System Roles screen" width="300" height="226" class="aligncenter size-medium wp-image-13336" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-prefix-300x226.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-prefix-768x578.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-prefix.png 1023w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And that how it looks now, in both Qt and Ncurses, with the new format.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-qt-300x225.png" alt="The properly formatted text of the System Roles screen" width="300" height="225" class="aligncenter size-medium wp-image-13337" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-qt-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-qt-768x577.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-qt.png 1022w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses-300x224.png" alt="Proper format even in text mode" width="300" height="224" class="aligncenter size-medium wp-image-13338" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses-300x224.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses-768x574.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses-1024x765.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/08/roles-ncurses.png 1028w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Fixed PHP support in the YaST HTTP server module</h3>
<p>The YaST HTTP server module allows enabling the PHP support in the Apache web server configuration. However, as the module is not actively developed it turned out that the PHP support was broken. YaST wanted to install the <code>apache2-mod_php5</code> package which is not available in openSUSE Leap 15.0 or SLE15, there is a newer <code>apache2-mod_php7</code> package.</p>
<p>After checking the other required packages it turned out that a similar problem exists for some other Apache modules. To avoid this issue in the future again we have added an additional test which checks the availability of all potentially installed packages. If there is a new version or a package is dropped we should be notified earlier by continuous integration instead of an user bug report later.</p>
<h3>Stay tuned</h3>
<p>Of course, in addition to the mentioned highlights we have fixed several small and medium bugs. And we plan to continue improving YaST in many ways&#8230; and to keep you punctually updated. So don&#8217;t go too far away.</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/08/29/yast-sprint-61/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>YaST Squad Sprint 59 &#038; 60</title>
		<link>https://lizards.opensuse.org/2018/08/22/yast-squad-sprint-59-60/</link>
		<comments>https://lizards.opensuse.org/2018/08/22/yast-squad-sprint-59-60/#respond</comments>
		<pubDate>Wed, 22 Aug 2018 08:17:20 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Factory]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13291</guid>
		<description><![CDATA[We know, we know&#8230; we owed you a report for the 59th sprint! But you know what? We are now delivering this summary which covers sprints 59 and 60 so we are now up to date again. During these weeks, we have been working mainly in two different areas. On one hand, we have improved [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>We know, we know&#8230; we owed you a report for the 59th sprint! But you know what? We are now delivering this summary which covers sprints 59 and 60 so we are now up to date again.</p>
<p>During these weeks, we have been working mainly in two different areas. On one hand, we have improved YaST services management capabilities, adding support for <em>on demand</em> services and making the user experience slightly better. On the other hand, we are still working in the new storage layer, extending it to support Xen virtual partitions and fixing BIOS MD devices handling, among other things.</p>
<p>Last but not least, our bug fighting squad (do you remember <a href="//lizards.opensuse.org/2018/07/05/yast-development-update/">squads</a>, right?) have fixed quite some bugs accross our full stack.</p>
<p>So let&#8217;s have a tour to recap some highlights from these sprints.</p>
<h3 id="services-management-gets-some-love">Services Management Gets Some Love</h3>
<p>The team is investing quite some time improving the services management area. In the past, YaST was adapted to play nicely with Systemd (which replaced the old runlevel-based init system). However, there was a lot of room for improvement, as Systemd added some new features when it comes to services management that were not supported in YaST at all.</p>
<p>To explore these changes, let’s start by having a look at the new services manager user interface.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/services-manager-2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/services-manager-2-300x246.png" alt="Services Manager UI with On Demand Activation Support" width="300" height="246" class="aligncenter size-medium wp-image-13309" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/services-manager-2-300x246.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-manager-2-768x629.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/services-manager-2.png 818w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>At first sight, you may have spotted some changes: there is an <em>Start Mode</em> menu button where the <em>Enable/Disable</em> used to be; new <em>Apply</em> or <em>Show Logs</em> buttons have been added; the <em>Start/Stop</em> button has been replaced by an <em>Start</em> (or <em>Stop</em>) one… Ok, let’s describe these changes one by one.</p>
<p>Perhaps the most relevant update is the support for <a href="https://www.freedesktop.org/software/systemd/man/systemd.socket.html">socket</a> activated services. But you may be asking what a “socket activated service” is, right? In a nutshell, these are services that are started on demand. For instance, the printing service could be started only when you want to use the printer. And that’s what the <em>Start Mode</em> button is all about. For instance, you may want the printing services to be started only when needed (<em>On Demand</em>) and YaST will take care of setting up Systemd units in order to do so.</p>
<p>Another interesting feature is browsing services logs. Beware that this button will be available only if <code>yast2-journal</code> is installed because it uses the browser provided by this package.</p>
<p>And browsing the logs brings us to the new <em>Apply</em> button. Sometimes, it may be useful to <em>Start</em> a service and check the logs looking for potential problems. In the past, the changes were applied when the <em>OK</em> button was pressed but, unfortunately, the services manager was then closed. Now, with the <em>Apply</em> button, you can ask YaST to made those changes for real without closing the services manager (and check the logs or keep adjusting services).</p>
<p>But that’s not all! Among other small changes (like fixing <a href="https://bugzilla.suse.com/show_bug.cgi?id=1080738#c3">bug #1080738</a>) we are still improving the UX for this services manager.</p>
<h3 id="make-the-xen-virtual-partitions-great-again">Make the Xen virtual partitions great again</h3>
<p>Rewriting a piece of YaST that is 20 years old is a never-ending source of surprises. When we though that Storage-ng did already support all the storage technologies handled by the old storage stack, we just found that we had left something behind.</p>
<p>When setting a <a href="http://www.xen.org">Xen</a> virtualization environment, it’s possible to define block devices that are seen and named like partitions in the Xen guest, but are in fact disks (or almost-disks, since they cannot be partitioned by regular methods). In other words, the Xen guest can see some block devices called e.g. <code>/dev/xvda1</code> and <code>/dev/xvda2</code> without a corresponding <code>/dev/xvda</code>.</p>
<p>From the YaST point of view, you can do whatever you can do with a partition (format it, mount it, etc.), except you can’t delete them or create more (since they are not backed by a disk, from the perspective of the Xen guest). We call those devices “Xen virtual partitions”. The old storage stack used to pretend those devices were just plain partitions of a made-up <code>/dev/xda</code> disk that was not there in the system but still appeared in the Partitioner and in the AutoYaST profile. The new stack simply contained no support at all for Xen virtual partitions.</p>
<p>We fixed that during the last sprint, making the feature available on the SLE-15 installation process thanks to the installer self-update feature. So either if your Xen guest runs a fully up-to-date version of SLE-15, Leap 15.0 or Tumbleweed or if you are installing SLE-15 with access to the installer self-update repositories, virtual partitions are visible in the <em>Hard Disks</em> section of the Partitioner.</p>
<p>It works in a in a similar way to the old (pre Storage-NG) Partitioner, but without artificial disks to group the virtual partitions. See the following screenshots in which <code>xvda</code> is a DVD, <code>xvdb</code> a real disk and <code>xvdc1</code> a XEN virtual partition (there is no bogus <code>xvdc</code> added by YaST).</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-300x185.png" alt="Handling Xen Virtual Partitions" width="300" height="185" class="aligncenter size-medium wp-image-13319" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-300x185.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-768x472.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions.png 972w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Only the <em>Edit</em> button really works as expected, allowing the user to mount and/or format the virtual partition. The other buttons just show the appropriate error for the different unsupported operations.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-error.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-error-300x184.png" alt="Handling Xen Virtual Partitions Error Message" width="300" height="184" class="aligncenter size-medium wp-image-13320" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-error-300x184.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-error-768x472.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/xen-virtual-partitions-error.png 971w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="i-want-that-on-my-leap-150-installer">I want that on my Leap 15.0 installer</h3>
<p>As a side note on the Xen partitions topic, it’s worth mentioning that the self-update feature of the installer is always available for all YaST-based distributions. But, unlike SLE, openSUSE doesn’t offer an official self-update repository, implying the feature is effectively disabled by default in openSUSE Leap. Does it mean that if you want to install Leap on top of a Xen virtual partition you will have to wait for Leap 15.1 or switch to Tumbleweed? Not exactly.</p>
<p>If you really want to use the latest YaST features during the openSUSE Leap 15.0 installation process, there are a couple of ways to achieve it. For example, to install (or upgrade) using the Leap 15.0 Live images. The live images are refreshed once in a while, so they can contain an installer that is more up-to-date than the installer in the Leap 15.0 normal ISO. There are also ways to use the self-update feature with unofficial (and unsupported) repositories. For a summary of all the options, <a href="https://bugzilla.opensuse.org/show_bug.cgi?id=1094749#c21">check this comment at Bugzilla</a>. Users of SLE should not need any of these hacks, since there is an official repository for the installer self-update mechanism ensuring SLE15 can always be installed with updated version of all the crucial packages.</p>
<h3 id="a-new-widget-to-manage-services">A New Widget To Manage Services</h3>
<p>Did you think that services management were confined to the services manager? Of course no <img src="https://s.w.org/images/core/emoji/2.2.1/72x72/1f642.png" alt="&#x1f642;" class="wp-smiley" style="height: 1em; max-height: 1em;" /> As you may know, there are serveral YaST modules that allow our users to set up several services like DNS, DHCP, Samba, etc. All these modules offer a way to configure how and when those services should be started.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/new-service-widget.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/new-service-widget-300x235.png" alt="" width="300" height="235" class="aligncenter size-medium wp-image-13313" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/new-service-widget-300x235.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/new-service-widget-768x601.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/08/new-service-widget.png 806w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>So as part of the effort to improve the services management experience, we have rolled out a <a href="https://github.com/yast/yast-yast2/blob/db84777929d56c2ce13bcef9ac6e1ab16950b19b/library/systemd/src/lib/yast2/service_widget.rb#L26">new widget</a> which offers some benefits:</p>
<ul>
<li>Allows setting a service to be started <em>On Demand</em>.</li>
<li>Offers a consistent an unified interface accross all modules.</li>
<li>It is able to handle cases where several services are involved (like <code>yast2-samba-server</code> or <code>yast2-iscsi-client</code>).</li>
</ul>
<p>By the way, we have adapted all these modules to use the new and shiny widget.</p>
<h3 id="better-handle-large-file-systems-in-libyui">Better Handle Large File Systems in libyui</h3>
<p>We fixed an issue with disks larger than 8<a href="https://en.wikipedia.org/wiki/Exbibyte">EiB</a> in the <a href="https://lizards.opensuse.org/2018/07/23/yast-squad-sprint-58/#fixed-issues-with-disks-larger-than-8eib">last sprint</a>. However, the fix was intended for SLE12 and SLE15 maintenance update so we could not do big changes and we fixed only the most important parts.</p>
<p>For SLE15-SP1/Leap 15.1 and openSUSE Tumbleweed we can do more changes so we did some backward incompatible improvements.</p>
<p>Originally the size was implemented using <code>long long</code> data type which is a 64-bit signed integer (with the maximum value 8EiB). We switched to the <a href="https://www.boost.org/doc/libs/release/libs/multiprecision/doc/html/index.html">Boost multiprecision</a> C++ library which implements arbitrary precision integers. It works like the <a href="https://ruby-doc.org/core-2.5.0/Integer.html">Integer</a> class in Ruby which adds more bits to the data when needed.</p>
<p>Of course, it still depends on the limits in the underlying libzypp library which uses a 64-bit signed integer but with 1KiB unit, so the limit should be 8ZiB. With this change we are prepared even for more.</p>
<p>Additionally we added more units for converting to a string representation. Originally it used TiB units which resulted in too big numbers, now the EiB sizes are displayed using the EiB units as expected.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/08/libyui-large-filesystems.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/08/libyui-large-filesystems-300x157.png" alt="Large filesystems support in Libyui" width="300" height="157" class="aligncenter size-medium wp-image-13293" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/08/libyui-large-filesystems-300x157.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/08/libyui-large-filesystems.png 388w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Moreover we added support for writing unit tests, evaluating the code coverage and reporting the it to <a href="https://coveralls.io/github/libyui/libyui">coveralls.io</a>. With this support we were able to write the very first unit test in libyui! The code coverage is now at the embarrassing 2% but we have just started!</p>
<h3 id="rubocop-check-speed-up">Rubocop Check Speed Up</h3>
<p>In the <a href="https://lizards.opensuse.org/2018/07/23/yast-squad-sprint-58/#speeding-up-unit-tests-and-travis-builds-in-yast2-storage-ng">previous blog post</a> we reported that we had improved running the unit tests in the <code>yast2-storage-ng</code> package. The speed up was based on parallelizing the execution and using all processors. This time we have improved the <a href="https://github.com/rubocop-hq/rubocop">Rubocop</a> check.</p>
<p>Normally Rubocop scans the directory for the files to check and then processes found files sequentially. And this might take very long time if there are hundreds of files to check.</p>
<p>Similarly as in the previous speed up we take advantage of the available processors and run multiple Rubocop instances in parallel. The implementation is a bit more complicated as Rubocop itself does not support parallel scan at all. But it is possible to evaluate the checked files, split them into the groups according to the number of processors and start a separate Rubocop instance for each group in parallel.</p>
<p>If you are interested in the details or you want to use parallel Rubocop also in your project then check the <a href="https://github.com/yast/yast-rake/blob/b3b2a4acae18931b84d67aa440133585bb1fb77a/lib/tasks/rubocop.rake#L19-L30">implementation</a> in the <code>yast-rake</code> Ruby gem.</p>
<p>Of course, this improvement has an important impact in the yast2-storage-ng package where Rubocop needs to check over 600 files. Here you are the numbers:</p>
<ul>
<li>Running Rubocop locally (with hyperthreading enabled):
<ul>
<li>~3.6x faster on an older quad core CPU (from 44s to 12s)</li>
<li>~6x faster on a new eight core CPU (from 35s to 6s)</li>
</ul>
</li>
<li>At <a href="https://travis-ci.org/yast/yast-storage-ng">Travis</a>: ~1.5x faster (from 69s to 47s), that’s the maximum possible because Travis has about 1.5x CPU build power</li>
<p>.
</ul>
<p>As you can see, for big projects the speed up is very good on local system and even at Travis it is still nice.</p>
<h3 id="whats-next">What&#8217;s next?</h3>
<p>Sprint 61 is already running and the new storage layer and services management are again the areas where we are focusing an important part of our resources. Hopefully, in around two weeks, we will publish what we have achieved this time.</p>
<p>Stay tunned!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/08/22/yast-squad-sprint-59-60/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>zypper-upgraderepo-plugin is here</title>
		<link>https://lizards.opensuse.org/2018/08/07/zypper-upgraderepo-plugin-is-here/</link>
		<comments>https://lizards.opensuse.org/2018/08/07/zypper-upgraderepo-plugin-is-here/#comments</comments>
		<pubDate>Tue, 07 Aug 2018 18:55:25 +0000</pubDate>
		<dc:creator><![CDATA[FabioMux]]></dc:creator>
				<category><![CDATA[Software Management]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[Ruby]]></category>
		<category><![CDATA[zypper]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13239</guid>
		<description><![CDATA[zypper-upgraderepo-plugin adds to zypper the ability to check the repository URLs either for the current version or the next release, and upgrade them all at once in order to upgrade the whole system from command line. This tool started as a personal project when a day I was in the need to upgrade my distro [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>zypper-upgraderepo-plugin adds to zypper the ability to check the repository URLs either for the current version or the next release, and upgrade them all at once in order to <a href="https://en.opensuse.org/SDB:System_upgrade">upgrade the whole system from command line</a>.</p>
<p>This tool started as a personal project when a day I was in the need to upgrade my distro quicker than using a traditional ISO image, Zypper was the right tool but I got a little stuck when I had to handle repositories: some of them were not yet upgraded, others changed slightly in the URL path.</p>
<p>Who knows how <em>to Bash</em> the problem is not exactly a nightmare, and so I did until I needed to make a step further.</p>
<p>The result is <a href="https://rubygems.org/gems/zypper-upgraderepo">zypper-upgraderepo</a> Ruby gem which can be integrated as a zypper plugin just installing the zypper-upgraderepo-plugin package.</p>
<h3>Installing zypper-upgraderepo-plugin</h3>
<p>Installing <em>zypper-upgraderepo-plugin</em> is as easy as:</p>
<ol>
<li>Adding my repo:<br />
<code>sudo zypper ar https://download.opensuse.org/repositories/home:/FabioMux/openSUSE_Leap_42.3/home:FabioMux.repo</code></li>
<li>Install the package:<br />
<code>sudo zypper in zypper-upgraderepo-plugin</code></li>
</ol>
<h3>How to use it</h3>
<p>Sometime we want to know the status of current repositories, the command <em>zypper ref</em> does a similar job but it is primarily intended to update the repository&#8217;s data and that slow down a bit the whole process.<br />
Instead we can type:<br />
<code><br />
$ zypper upgraderepo --check-current<br />
</code><br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451.png"><img class="alignnone size-medium wp-image-13242" src="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451-300x179.png" alt="" width="300" height="179" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451-300x179.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451-768x457.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451-1024x610.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174451.png 1060w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>To know whether or not all the available repositories are <em>upgrade-ready</em>:<br />
<code><br />
$ zypper upgraderepo --check-next<br />
</code><br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520.png"><img class="alignnone size-medium wp-image-13243" src="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520-300x179.png" alt="" width="300" height="179" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520-300x179.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520-768x457.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520-1024x610.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174520.png 1060w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
As you can see from the example above all the enabled repositories are ready to upgrade except for the OSS repo which has a slightly different URL.<br />
<code><br />
# The URL used in the openSUSE Leap 42.3<br />
http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/<br />
# The suggested one for openSUSE Leap 15.0<br />
http://download.opensuse.org/distribution/leap/15.0/repo/oss/<br />
</code></p>
<p>Let&#8217;s try again overriding the URL without make any real change:<br />
<code><br />
$ zypper upgraderepo --check-next \<br />
--override-url 8,http://download.opensuse.org/distribution/leap/15.0/repo/oss/<br />
</code><br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904.png"><img class="alignnone size-medium wp-image-13244" src="//lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904-300x179.png" alt="" width="300" height="179" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904-300x179.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904-768x457.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904-1024x610.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/Screenshot_20180703_174904.png 1060w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Once everything is ok, and after performed a backup including all the repositories, it&#8217;s time to upgrade all the repository at once:<br />
<code><br />
$ sudo zypper upgraderepo --upgrade \<br />
--override-url 8,http://download.opensuse.org/distribution/leap/15.0/repo/oss/<br />
</code></p>
<h3>Conclusions</h3>
<p>That&#8217;s all with the basic commands, more information is available in the wiki page of <a href="https://github.com/fabiomux/zypper-upgraderepo/wiki">zypper-upgraderepo</a> gem where all the commands are intended with the only use of the gem, but installing the plugin they are also available as zypper subcommands like shown above, also a man page is available as<br />
<code><br />
$ zypper help upgraderepo<br />
</code></p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/08/07/zypper-upgraderepo-plugin-is-here/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>YaST Squad Sprint 58</title>
		<link>https://lizards.opensuse.org/2018/07/23/yast-squad-sprint-58/</link>
		<comments>https://lizards.opensuse.org/2018/07/23/yast-squad-sprint-58/#respond</comments>
		<pubDate>Mon, 23 Jul 2018 06:20:50 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Factory]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13278</guid>
		<description><![CDATA[Squads in the Team In the previous post we explained the squads idea and said we would tell more in this report. Thus, we should mention that we finally did three squads for this sprint: The Sockets &#38; Services Squad working on supporting systemd sockets properly and other systemd related tasks (all in the YaST [&#8230;]]]></description>
				<content:encoded><![CDATA[<h3 id="squads-in-the-team">Squads in the Team</h3>
<p>In the previous post we explained the squads idea and said we would tell more in this report. Thus, we should mention that we finally did three squads for this sprint:</p>
<ul>
<li>The <em>Sockets &amp; Services Squad</em> working on supporting systemd sockets properly and other systemd related tasks (all in the YaST context, of course).</li>
<li>The <em>Qt and UI Squad</em> working on user interface things like adding a new view to the package selection to show packages managed by a service, and also some control center improvements.</li>
<li>The <em>Bug Fighting Squad</em> handling bugs that are coming in on a daily basis and in our backlog.</li>
</ul>
<h3 id="fixed-issues-with-disks-larger-than-8eib">Fixed Issues with Disks Larger than 8EiB</h3>
<p>It&#8217;s quite unlikely that you have at home a disk storage larger than 8EiB (eight <a href="https://en.wikipedia.org/wiki/Exbibyte">exbibytes</a>, 2<sup>63</sup>). But in enterprise or cloud world it might be possible.</p>
<p>And it turned out that the YaST package manager does not handle such large disks well. At the start you would see this false error message:</p>
<h4 id="the-problems">The Problems</h4>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-3.png"><img class="aligncenter size-medium wp-image-13282" src="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-3-300x230.png" alt="" width="300" height="230" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-3-300x230.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-3.png 353w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
There are two problems:</p>
<ul>
<li>There definitely is a lot of free space on the disk, the error telling the user the space is running out is simply lying.</li>
<li>The disk sizes are displayed as wrong negative values.</li>
</ul>
<p>It turned out that the problem was caused by using the <em>signed</em> 64-bit integer data type which overflows for values bigger than 8EiB and the number becomes negative.</p>
<h4 id="the-fix">The Fix</h4>
<p>We had to fix several places, each required some different solution.</p>
<ul>
<li>Use <em>unsigned</em> 64-bit integers where possible, that obviously avoids overflow.</li>
<li>The numbers from libzypp use KiB units, at some places we need to convert that number to MiB. But first we converted to plain bytes (by multiplying by 1024) and then divide by 1MiB. And this first multiply step might cause overflow. Instead we simply convert KiB to MiB directly by dividing by 1024 without risk of overflow in the middle.</li>
<li>Use floating point <code>double</code> data type for converting the values to a human readable text or to percents. The <code>double</code> has wider range and in these cases we do not need exact precision so rounding in floating point operations does not matter.</li>
<li>Ignore a negative number in the free space check. At one place the value goes through the YaST component system which uses <em>signed</em> integer and this cannot be easily changed. In that case we consider negative free space as enough for installing any package, more than 8EiB free space should be enough for any package™.</li>
</ul>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-4.png"><img class="aligncenter size-medium wp-image-13283" src="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-4-300x173.png" alt="" width="300" height="173" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-4-300x173.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-4.png 392w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
There is still some minor issue with the large numbers. The highest supported unit is TiB so even very big numbers are displayed in TiB units as on the screenshot above. The fix is planned to be released as a maintenance update and this change would break the backward compatibility so we will improve it later but only for the future releases.</p>
<h4 id="testing">Testing</h4>
<p>But the problem was how to test the behavior? You could fake some numbers in the code but for full testing or QA validation it would be nice to test on a real disk. But you usually do not have such a large storage for testing&#8230;</p>
<p>Fortunately in Linux it is possible to fake such large file system quite easily using <a href="https://en.wikipedia.org/wiki/Sparse_file">sparse files</a> and <a href="https://en.wikipedia.org/wiki/Loop_device">loop devices</a>. Here is a short how to:</p>
<div class="sourceCode">
<pre class="sourceCode sh"><code class="sourceCode bash"><span class="co"># create two big sparse files</span>
<span class="ex">truncate</span> -s 6E /tmp/huge_file1
<span class="ex">truncate</span> -s 6E /tmp/huge_file2

<span class="co"># create block devices via loopback</span>
<span class="ex">losetup</span> -f /tmp/huge_file1
<span class="ex">losetup</span> -f /tmp/huge_file2

<span class="co"># get the loop back device names, the names might be different</span>
<span class="co"># if the system already uses some other loop back devices</span>
<span class="ex">losetup</span> -a
<span class="ex">/dev</span>/loop1: [<span class="ex">0056</span>]:1171324 (/tmp/huge_file2)
<span class="ex">/dev</span>/loop0: [<span class="ex">0056</span>]:1171323 (/tmp/huge_file1)

<span class="co"># create a btrfs file system over both "disks"</span>
<span class="ex">mkfs.btrfs</span> -K /dev/loop0 /dev/loop1

<span class="co"># mount it on /mnt2 (or whatever else, do no use /mnt, that is ignored by libzypp!)</span>
<span class="fu">mkdir</span> /mnt2
<span class="fu">mount</span> /dev/loop0 /mnt2

<span class="co"># verify the size</span>
<span class="fu">df</span> -h /mnt2
<span class="ex">Filesystem</span>      Size  Used Avail Use% Mounted on
<span class="ex">/dev/loop0</span>       12E   17M   12E   1% /mnt2
<span class="co"># voila! you have a 12EiB file system! enjoy <img src="https://s.w.org/images/core/emoji/2.2.1/72x72/1f609.png" alt="&#x1f609;" class="wp-smiley" style="height: 1em; max-height: 1em;" /></span></code></pre>
</div>
<p>Note: Obviously even if you have a 12EiB filesystem you cannot save there more data than in the real file system below (in <code>/tmp</code> in this case). If you try you will get write errors, there is no prepetuum mobile&#8230;</p>
<h3 id="speeding-up-unit-tests-and-travis-builds-in-yast2-storage-ng">Speeding Up Unit Tests and Travis Builds in yast2-storage-ng</h3>
<p>The new yast2-storage-ng package has a quite large set of unit tests. That&#8217;s good, it allows to have less buggy code and make sure the features work as expected.</p>
<p>On the other hand the drawback is that running the tests take too much time. If you have to wait for 3 or 4 minutes after any small change in the code then either you waste too much time or you do not run the tests at all. So we looked into speeding up the tests.</p>
<h4 id="running-tests-in-parallel">Running Tests in Parallel</h4>
<p>The main problem was that all tests were executed sequentially one by one. Even if you have a multi CPU system only one processor was used. It turned out that using the <a href="https://github.com/grosser/parallel_tests">parallel_test</a> Ruby gem allows easily running the tests in parallel utilizing all available processors.</p>
<p>The only possible problem is that there must not be any dependencies or conflicts between the tests otherwise running them in parallel would fail. Fortunately there was only one small issue in the yast2-storage-ng tests and we could enable the parallel tests without much work.</p>
<h4 id="running-travis-jobs-in-parallel">Running Travis Jobs in Parallel</h4>
<p>Also the Travis job took quite a lot of time. Running the tests in parallel helped a bit at Travis but still was not good enough.</p>
<p>Fortunately Travis allows running multiple jobs in parallel. Therefore we split the single CI job which runs the tests, builds the package, runs syntax check, etc&#8230; into three independent groups which can be started in parallel.</p>
<h4 id="documentation">Documentation</h4>
<p>If you are interested in details you might check our updated <a href="http://yastgithubio.readthedocs.io/en/latest/travis-integration/#parallel-build-jobs">Travis documentation</a> and the <a href="http://yastgithubio.readthedocs.io/en/latest/how-to-write-tests/#parallel-tests">Parallel tests documentation</a>. Or check the <a href="https://lists.opensuse.org/yast-devel/2018-06/msg00024.html">announcement</a> on the YaST mailing list.</p>
<h4 id="results">Results</h4>
<p>Here are some real numbers to see the speedup:</p>
<ul>
<li>Running the test suite locally (<code>rake test:unit</code>): from 2:44 to 0:38 (4.3x speed up on a quad core CPU with hyper-threading enabled)</li>
<li>Building the package locally (<code>rake osc:build</code>): from 137s to 49s (with cached RPM packages but includes chroot installation)</li>
<li>Package build in OBS: from 323s-505s to 102s-235s (it highly depends on the speed of the used worker)</li>
<li>Travis speed up: from 8-10 minutes to 3-4minutes (using both parallel Travis jobs and parallel tests)</li>
</ul>
<p>This allows us to continue with adding even more tests into the package. :smiley:</p>
<h3 id="what-packages-are-provided-by-a-product-extensionmodule">What Packages are Provided by a Product Extension/Module?</h3>
<p>In the Software Management module we have a Repositories view where you can see the packages grouped by the repository that provides them. But this is not really helpful if you want to see what is delivered with a product <em>Extension</em> or <em>Module</em>, because each product module is composed of several repositories: the originally released packages, the updates, the sources, the debuginfos.</p>
<p>Fortunately, the repositories for each product module are grouped together in a repository Service, and we have added a <em>Services</em> filter to Software Management.</p>
<p>Qt Service filter:<br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-1.png"><img class="aligncenter size-medium wp-image-13280" src="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-1-300x223.png" alt="" width="300" height="223" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-1-300x223.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-1-768x572.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-1.png 963w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>ncurses Service filter:<br />
<a href="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2.png"><img class="aligncenter size-medium wp-image-13281" src="//lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2-300x161.png" alt="" width="300" height="161" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2-300x161.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2-768x411.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2-1024x548.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/sq1-2.png 1198w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>(Reference: <a class="uri" href="https://fate.suse.com/320573">https://fate.suse.com/320573</a>)</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/07/23/yast-squad-sprint-58/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Update on YaST Development Status</title>
		<link>https://lizards.opensuse.org/2018/07/05/yast-development-update/</link>
		<comments>https://lizards.opensuse.org/2018/07/05/yast-development-update/#comments</comments>
		<pubDate>Thu, 05 Jul 2018 15:53:56 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Miscellaneous]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13248</guid>
		<description><![CDATA[Five weeks without blogging is certainly a quite an hiatus for the YaST Team. But fear no more, we are back! This is the first time in quite a while in which our post is not titled &#8220;Highlights of YaST Development Sprint&#8221; and there are good reasons for that. Adapting the YaST Team Structure the [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Five weeks without blogging is certainly a quite an hiatus for the YaST Team. But fear no more, we are back! This is the first time in quite a while in which our post is not titled &#8220;Highlights of YaST Development Sprint&#8221; and there are good reasons for that.</p>
<h3>Adapting the YaST Team Structure the Agile Way</h3>
<p>Now that openSUSE Leap 15.0 is out and SUSE Enterprise Linux 15 is ready to be shipped, we felt it was time to rethink our activities. For the duration of the storage-ng development, we had split the YaST team into two sub-teams: Team S for <strong>S</strong>torage and Team R for the <strong>R</strong>est. But now new challenges await us; there are some things that were pushed aside because getting storage-ng into an acceptable state had top priority.</p>
<p>We decided we&#8217;d try an approach that other development teams in SUSE have already been using successfully: split up the YaST team into &#8220;squads&#8221; of 3-5 people each for the duration of a couple of sprints. Each squad is centered around a big topic that needs to be addressed. There is no long-term fixed assignment of anyone to any squad; the idea is to shuffle people and thus know-how around as needed, of course taking each developer&#8217;s interests into account. So the squads and the topics will change every few weeks.</p>
<p>Is this the pure spirit of Scrum and the agile bible? We don&#8217;t know. And we don&#8217;t care. The agile spirit is to adapt your work based on what makes sense in every moment. We work the agile way, so the way of working also has to be agile.</p>
<p>The next sprint&#8217;s report will contain more information about the first set of squads and the results they are delivering. But meanwhile we have done much more than just reorganizing our forces. While the sprint-based work was suspended (thus the blog title not containing the word &#8220;sprint&#8221;), the YaST team still managed to put out of the door quite some features, improvements and bug fixes targeting mainly Tumbleweed.</p>
<h3>Expert Partitioner: Moving Partitions</h3>
<p>After quite some effort, the YaST team has completely rewritten the Expert Partitioner from scratch using the new storage stack (a.k.a. storage-ng). And although this new Expert Partitioner already offers practically all the same features than the old one, some last options are still coming. One them in the button for moving partitions, which saves us of a lot unnecessary work in many cases. For example, imagine you are installing openSUSE Tumbleweed and the installer automatically proposes you to create a partition for root and, just following it, a second partition for home. In case you don&#8217;t like the default proposed sizes (e.g. because you want a bigger root), you have to use the Expert Partitioner to fix the situation. You have to completely remove the home partition, resize root for enlarging it and then create home again with the same options than before.</p>
<p>Now, with the &#8220;Move&#8221; button, this kind of modifications are much easier. For that example, you can accomplish exactly the same by simply resizing home (without deleting it completely) and moving the resized home closer to the end of the disk (by using Move button). After moving the home partition, you have enough free space for enlarging the root partition. In the following screenshot you can see this dialog for moving partitions.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/moving1.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/moving1-300x225.png" alt="Moving partitions" width="300" height="225" class="aligncenter size-medium wp-image-13253" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/moving1-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/moving1-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/moving1.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>One important thing to take into account is that the movement of partitions is only possible for new partitions, that is, it is not possible to move partitions that already exist on disk.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/nomoving.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/nomoving-300x225.png" alt="Trying to move an existing partition" width="300" height="225" class="aligncenter size-medium wp-image-13254" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/nomoving-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/nomoving-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/nomoving.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>YaST Masking Systemd Mount and Swap Units</h3>
<p>And speaking about the Partitioner and its relationship with the rest of the system, the transition from SysVinit to Systemd changed the behavior of (open)SUSE concerning mounting devices. Systemd generates mount units for various file systems, e.g. those listed in <code>/etc/fstab</code>. The result is that Systemd may automatically mount any file system, even if that file system has been manually unmounted before. This can be problematic when the user needs the file system to be unmounted for certain operations, like resizing or unplugging.</p>
<p>Thus, now the Partitioner uses a new mechanism to prevent that to happen during its execution. Starting with version 4.0.194, the <code>yast2-storage-ng</code> package includes and uses the script <code>/usr/lib/YaST2/bin/mask-systemd-units</code> to mask all mount and swap units one by one. The script might also be useful for direct use of system administrators. So&#8230; profit!</p>
<h3>Showing Logs the Systemd Way</h3>
<p>And since we speak about how Systemd has changed the way the overall system works, it&#8217;s also worth noticing how more and more services has been adopting the Systemd journal for its logging purposes.</p>
<p>Some of the existing YaST modules to configure a given service include a button to show the logs of such service. In the past, they used to display the content of <code>/var/log/messages</code> with some basic filtering to ensure only the information relative to the service (e.g. <code>tftp</code>) was shown. But that didn&#8217;t work out of the box for services already using the Systemd journal, and we had gotten quite some bug reports about it.</p>
<p>Fortunately, the solution is really at our fingertips. You surely know by now that there is a YaST module for viewing the  journal content with powerful queries for filtering, searching and so so on.  The obvious solution is to use that YaST journal module also within other YaST modules, in order to show domain specific logs.</p>
<p>So far we adapted the YaST tftp module, but it will be easy to fix also other places that use the old approach that no longer works. And this is how it looks when you click the &#8220;Show Logs&#8221; button in the YaST module to configure tftp.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/tftp-journal-entries.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/tftp-journal-entries-300x201.png" alt="Journal entries for the tftp module" width="300" height="201" class="aligncenter size-medium wp-image-13256" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/tftp-journal-entries-300x201.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/tftp-journal-entries-768x514.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/tftp-journal-entries.png 999w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Usability Improvement in the Repositories Manager</h3>
<p>The YaST repositories manager displays the repositories sorted by priority. But some people have a lot of repositories in their system and make no use of the priorities. Since there was not a clear second criteria, the order of the repository list looked quite arbitrary in those cases. Now all the repositories with the same priority are sorted by name, which makes more sense. See how it looked before the improvement.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/repos-before.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/repos-before-300x193.png" alt="List of repositories sorted only by priority" width="300" height="193" class="aligncenter size-medium wp-image-13258" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-before-300x193.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-before-768x494.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-before-1024x659.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-before.png 1345w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And compare to how it looks now.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/repos-after.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/repos-after-300x192.png" alt="List of repositories sorted by priority and name" width="300" height="192" class="aligncenter size-medium wp-image-13259" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-after-300x192.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-after-768x491.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-after-1024x655.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/repos-after.png 1346w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Handling Inconsistent Boot Methods During Upgrade</h3>
<p>We got a rather interesting amount of bug reports for openSUSE Leap 15.0 about collisions between the <code>grub2</code> and <code>grub2-efi</code> bootloaders during the upgrade process. The root cause was that the installation medium used a different booting mode than the installed system being upgraded. For example, the installed system uses EFI boot but the upgrade is executed from a DVD booted via legacy mode (i.e. disabling EFI). In that case, the kernel running from the DVD does not expose some devices that are needed to write to the EFI boot manager. Moreover, it causes troubles to the updater itself, which does not expect this situation.</p>
<p>Looking at the majority of the bug reports, it is obvious that in most cases it happens by accident rather than the user consciously trying to mix both boot modes. So to improve the user experience we added a warning that will be displayed when this situation is detected, before starting the upgrade. That gives the user the possibility to fix the problem or to continue if the situation is really intentional.</p>
<p>Below you can see how it looks, both in graphical and text mode, in a patched openSUSE Leap 15.0 installation media, since the feature was developed too late to be included in the official installation images.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt-300x224.png" alt="Graphical warning about inconsistent boot mode" width="300" height="224" class="aligncenter size-medium wp-image-13261" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt-300x224.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt-768x575.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt-1024x766.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-qt.png 1028w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses-300x224.png" alt="Text-mode warning about inconsistent boot mode" width="300" height="224" class="aligncenter size-medium wp-image-13262" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses-300x224.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses-768x574.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses-1024x765.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/07/efi-warning-ncurses.png 1025w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>What&#8217;s Next? Hack Week!</h3>
<p>As commented at the beginning of the post, we have restarted the sprint-based work, although with a little twist to try out the squads approach. But before we come back to you to show the results of the first squad-based sprint, we have something else to do &#8211; <a href="https://hackweek.suse.com/">Hack Week 17!</a>.</p>
<p>Again it&#8217;s the time of the year for all SUSE Engineers (and any Open Source enthusiast willing to join) to innovate and learn new stuff. So please forgive us if we go too deep into playing and we are less responsive next week. See you again soon!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2018/07/05/yast-development-update/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 57</title>
		<link>https://lizards.opensuse.org/2018/05/31/yast-sprint-57/</link>
		<pubDate>Thu, 31 May 2018 13:02:21 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Events]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Miscellaneous]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13201</guid>
		<description><![CDATA[Three weeks from our last update on this blog. Time flies when you are busy! As you know, openSUSE Leap 15.0 was released in the meantime, which also means the active development of SLE15 is coming to an end&#8230; so time to look a little bit further into the future. That&#8217;s why we had a [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Three weeks from our last update on this blog. Time flies when you are busy! As you know, openSUSE Leap 15.0 was released in the meantime, which also means the active development of SLE15 is coming to an end&#8230; so time to look a little bit further into the future.</p>
<p>That&#8217;s why we had a face-to-face workshop with the whole YaST Team at the beautiful city of Prague during several days right before joining the <a href="https://events.opensuse.org/conference/oSC18">openSUSE Conference 2018</a>.</p>
<p>But we have done much more in three weeks than attending workshops and conferences. Apart from last-minute fixes, here you have a list of some interesting changes we have done in YaST in this period. Take into account that some of these changes didn&#8217;t make it into Leap 15.0, although all will be available in SLES15 and are probably already integrated into openSUSE Tumbleweed.</p>
<h3>Fine tuning installer behavior in small disks</h3>
<p>As you may know, the default installation of SLE and both openSUSE distribution enables Btrfs snapshots in the root partition alongside separate partitions for <code>/home</code> and swap. That means a default installation needs quite some space. In SLE12 and openSUSE Leap 42.X, if such disk space was not there the installer silently tries to disable the separate <code>/home</code> and even the snapshots in order to be able to create an initial proposal.</p>
<p>That behavior has become configurable for each product and role with Storage-ng and during the last sprint there was some controversy about what the configuration should be, both for openSUSE and the SLE family. It may look like a minor problem, but it becomes very relevant in virtualization environment (where virtual disks smaller than 10 GiB are not uncommon) or certain architectures with special storage devices like s390 and ARM.</p>
<p>The final decision was to never disable snapshots automatically in the case of openSUSE, so the user will be forced to manually go through the Guided Setup and explicitly disable snapshots to install in a small disk. In the SLE case, it was decided to keep the traditional behavior (automatically disabling snapshots if really needed) but making the situation more visible by adding a previous sentence to explain how the initial proposal was calculated.</p>
<p>So the installation in a normal disk would look like this.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/default.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/default-300x197.png" alt="Default initial partitioning proposal" width="300" height="197" class="aligncenter size-medium wp-image-13203" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/default-300x197.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/default.png 632w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>While the installation in a very small disk displays some information similar to the following screen (the wording was slightly improved after taking the screenshots).</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/minimal.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/minimal-300x192.png" alt="Adjusted initial partitioning proposal" width="300" height="192" class="aligncenter size-medium wp-image-13204" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/minimal-300x192.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/minimal.png 599w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The explanatory text preceding the list of actions will be available in all products based on SLE15, but will not be there for Leap 15.0, since the modification to the installer was not ready on time for the deadline and, moreover, would have been impossible to get the translations on time.</p>
<p>By the way, if you are interested in a more in-depth explanation on how the partitioning proposal adapts to all kind of situations like small disks and other scenarios, don&#8217;t hesitate to check Iván&#8217;s presentation at openSUSE Conference 2018 detailing its internals.</p>
<p><iframe width="500" height="281" src="https://www.youtube.com/embed/_0VKUjFAIwo?feature=oembed" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>
<h3>More parameter passing for s390</h3>
<p>And talking about uncommon scenarios and the s390 architecture, you may remember that in the latest sprint we improved the handling of the persistent network device names kernel parameter for such systems. Shortly after, we found out a similar improvement was needed also for the FIPS parameter.</p>
<p>FIPS is a military encryption standard in USA. If the installation is started using the corresponding parameter, YaST will enforce strong encryption and will install an specific FIPS pattern. Moreover, after the recent fix, a system installed in hardened mode s390 will continue operating in this mode after the installation.</p>
<h3>Fun with MD RAIDs</h3>
<p>As SLE15 comes closer, future users start testing the system with more exotic and complex hardware setups. Same applies to openSUSE Leap 15.0 right after the official release. As a result of all that testing, we found several scenarios in which Storage-ng got confused about MD RAIDs defined by some specific hardware or manually by the user before starting the installation.</p>
<p>By default, the old storage didn&#8217;t handle partitions within software RAIDs and it didn&#8217;t handle software RAIDs directly on top of full disks (with no partitions in the physical disks). For the first version of Storage-ng present in Leap 15.0 and SLE15, we tried to implement the same behavior with the intention to rethink the whole thing and open new possibilities in the close future. Check more about the present and future of Storage-ng in Ancor&#8217;s talk at openSUSE Conference 2018.</p>
<p><iframe width="500" height="281" src="https://www.youtube.com/embed/etsT3xP52Zs?feature=oembed" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>
<p>Unfortunately, while trying to replicate the old storage behavior with software-defined MD RAIDs, we overlooked some heuristic that was hidden in the old implementation to recognize some special setups in which a given RAID device currently detected as regular software-defined RAIDs should be treated like hardware RAIDs. That&#8217;s the case of Software RAID Virtual Disks defined on a S130/S140 controller on DellEMC PowerEdge Servers through the BIOS Interface. We also found that some users used to produce a similar situation by manually creating software MD RAIDs and creating partitions within them before starting the installation.</p>
<p>With the preparation of SLE15 already in the final stages and with openSUSE Leap 15 already out, it was too late to introduce drastic changes in how MD RAIDs are detected and used.  To mitigate the problem while limiting the potential breakage, we reintroduced an ancient installer parameter. Now, when we run the installer using <code>LIBSTORAGE_MDPART=1</code>, all existing software-defined RAIDs will be considered as BIOS RAIDs.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/raid.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/raid-300x225.png" alt="Using LIBSTORAGE_MDPART" width="300" height="225" class="aligncenter size-medium wp-image-13211" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/raid-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/raid-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/05/raid.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The new parameter is not available in Leap 15.0 (we added it too late) and will hopefully not be necessary anymore in future versions of SLE and openSUSE, since the short term plan is to redesign everything about how MD RAIDs are handled during installation.</p>
<h3>And even more fun with MD RAIDs</h3>
<p>Another example of RAID that looks like defined by software but is indeed assembled by BIOS is the Intel RSTe technology. In this case, the usage of <code>LIBSTORAGE_MDPART</code> is not needed, but still we found the bootloader installation to be broken because YaST was once again getting confused by the mixed RAID setup.</p>
<p>Fortunately it was possible to fix the issue and verify the solution in only two days, despite the YaST Team not having direct access to the hardware, thanks to the outstanding help of the user reporting the bug. Connecting users and developers directly always produces great results&#8230; and that&#8217;s one of the reasons open source rocks so much!</p>
<h3>Improved error reporting for wrong bootloader in AutoYaST</h3>
<p>That was not the only improvement in the bootloader handling done during this sprint. We also invested some time improving the user experience in AutoYAST, since the error message displayed when using an EFI variant not supported in the system architecture was far from being useful or even informative.</p>
<p>So alongside a more clear message, AutoYaST will now list all the possible values supported on the given architecture to better guide the user.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/bootloader.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/bootloader-300x227.png" alt="More precise bootloader error in AutoYaST" width="300" height="227" class="aligncenter size-medium wp-image-13216" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader-300x227.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader-768x582.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader-1024x776.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader.png 1025w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Setting the default subvolume name in AutoYaST</h3>
<p>AutoYaST also received improvements in other areas, like making use of the new possibilities offered by Storage-ng. The new storage layer allows the user to set different default subvolumes (or none at all) for every Btrfs file system. As shown in the example below, a prefix name can be specified for each partition using the <code>subvolumes_prefix</code>.</p>
<pre>
&lt;partition&gt;
  &lt;mount&gt;/&lt;/mount&gt;
  &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
  &lt;size&gt;max&lt;/size&gt;
  &lt;subvolumes_prefix&gt;@&lt;/subvolumes_prefix&gt;
&lt;/partition&gt;
</pre>
<p>To omit the subvolume prefix, set the <code>subvolumes_prefix</code> tag:</p>
<pre>
&lt;partition&gt;
  &lt;mount&gt;/&lt;/mount&gt;
  &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
  &lt;size&gt;max&lt;/size&gt;
  &lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;
&lt;/partition&gt;
</pre>
<p>As a consequence of the new behaviour, the old <code>btrfs_set_default_subvolume_name</code> tag is not needed and, therefore, it is not supported in Leap 15.0 and SLE15.</p>
<h3>Skipping Btrfs subvolume creation</h3>
<p>And more changes in AutoYaST that arrived just in time for SLE15 and openSUSE Leap 15.0. Recently, we have introduced a new flag in AutoYaST partition sections to skip the creation of Btrfs subvolumes because, due to a known limitation of our XML parser, it is not possible to specify an empty list.</p>
<p>So from now on, setting <code>create_subvolumes</code> to <code>false</code> will prevent AutoYaST from creating any Btrfs subvolumes in a given partition.</p>
<pre>
&lt;partition&gt;
  &lt;mount&gt;/&lt;/mount&gt;
  &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
  &lt;size&gt;max&lt;/size&gt;
  &lt;create_subvolumes config:type="boolean"&gt;false&lt;/create_subvolumes&gt;
&lt;/partition&gt;
</pre>
<h3>Keep it rolling!</h3>
<p>As usual, the content of this post is just a small part of everything we did during the sprint. There were also many other fixes and improvements, from auto-repairing wrong partition tables (with different sizes than the underlying disk) during installation to better interaction with other components like udisk or mdadm auto-assembling and many other things in between.</p>
<p>But it&#8217;s time to go back to work and start implementing all the new ideas that emerged from the YaST Team Workshop and the openSUSE Conference. See you in the next report!</p>
]]></content:encoded>
			</item>
		<item>
		<title>Highlights of YaST Development Sprint 56</title>
		<link>https://lizards.opensuse.org/2018/05/08/highlights-of-yast-development-sprint-56/</link>
		<pubDate>Tue, 08 May 2018 09:40:33 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Localization]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=13188</guid>
		<description><![CDATA[LEAP/SLE 15 is getting more stable and closer to be released, but to keep this process flowing, our team of bug killers is having a lot of work to do! This last sprint we had several fixes for really special scenarios. The kind of problems that you can find once most of things are working [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>LEAP/SLE 15 is getting more stable and closer to be released, but to keep this process flowing, our team of bug killers is having a lot of work to do!</p>
<p>This last sprint we had several fixes for really special scenarios. The kind of problems that you can find once <del>most of</del> things are working fine! So let&#8217;s take a look at some of these cases and how we&#8217;re working to stabilize this upcoming release.</p>
<h2>Keep predictable network devices settings on S390x</h2>
<p>A not well-known feature in YaST is that many specific boot parameters for installation are also used on the target system. However, this approach has one exception: the S390 mainframe. In this case, many installation specific parameters should not go to the target system and, therefore, we ignore all installation parameter for this system.<br />
In the last sprint, we worked on a bug, which reported that at least systemd predictable names for network devices should be also used for S390 systems, otherwise the configuration done during the installation won&#8217;t be valid in a running system as network names will differ. So, from SLE15 we start to keep the settings of predictable network names for S390 systems.</p>
<h2>Fun with console configuration of GRUB2</h2>
<p>Another report that helped us to learn about other not well-known features was the one reporting that bootloader module does not support multiple console outputs of GRUB2. After digging into some code, we found out that YaST bootloader takes only native terminal, gfxterm or serial console in consideration, but not a mix of them.<br />
Once we looked at the manual of GRUB2, we learned that it supports some funny outputs such as morse code, PC beeper or simple data protocol using system speaker. Of course, YaST2 bootloader does not support all these options and when it gets one of them, it is treated as an unexpected value and bootloader fails.</p>
<p>As we are really close to Leap/SLE 15 release, we want to avoid big changes in the system.  So we decided to handle this issue by showing a popup, which informs that the configuration contains an unexpected value and asks if the whole proposed configuration should be proposed again or if YaST should quit and let the user edit it manually.</p>
<p>If you are curious about how it looks like:</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub-300x192.png" alt="" width="300" height="192" class="aligncenter size-medium wp-image-13194" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub-300x192.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub-768x493.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub-1024x657.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/05/unsuported_conf_grub.png 1347w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>For Leap 15.1 / SLE 15 SP1 we plan to extend the values that we support to provide a nicer experience for the user.</p>
<h2>Bootloader configuration during upgrade</h2>
<p>Another reported issue in bootloader was also solved this last sprint. When upgrading from Leap 42/SLE 12 to Leap/SLE 15, if the user clicks on booting on the proposal, the system crashes. The reason is that usually on openSUSE 13.2/SLE 11 it needs to repropose bootloader during the upgrade. This is no longer required for the latest upgrade and, therefore, YaST does not expect that the user will click on it. We would like to remove this option completely, but YaST still support upgrade from SLE11 to SLE15,  so we still need it there. In the end, the solution is to show a popup informing the user that the modification of bootloader is not supported during upgrade.</p>
<p>In short, take a look at the screenshot:</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade.png"><img src="//lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade-300x220.png" alt="" width="300" height="220" class="aligncenter size-medium wp-image-13195" srcset="https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade-300x220.png 300w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade-768x564.png 768w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade-1024x753.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2018/05/bootloader_conf_upgrade.png 1030w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h2>Fixing kdump on Xen</h2>
<p>We got a report about <a href="https://en.wikipedia.org/wiki/Kdump_(Linux)">kdump</a> breaking when it is used in Xen. To explain the problem, we need to go back to how we configure a parameter and the reasons we implemented it in this way: In current versions (before this fix) when a user wants to use kdump,  we configure the crashkernel kernel parameter for all targets, for the common kernel, Xen PV0 domain and also Xen guests. This approach worked very well in the past because traditional xenlinux ignores crashkernel for PV0 and just pass it to Xen VMs. However, the current pvops implementation of Xen no longer ignores this parameter and consequently, it results in breaking the Xen virtualization. The solution for this issue was pretty simple: YaST stopped to propose using crashkernel for Xen PV0 and everything works again. This is a perfect example to show how to understand the issue, sometimes, takes much more time than to fix it!</p>
<h2>Improving the upgrade from SLE11/12 to SLE15</h2>
<p>We are still improving the migration from SLE11 or SLE12 to SLE15 and this sprint we were focused on the automated registration upgrade using AutoYaST. If you are not familiar with the autoupgrade feature you can find more details in the <a href="https://www.suse.com/documentation/sles-12/singlehtml/book_autoyast/book_autoyast.html#CreateProfile.upgrade">documentation</a>.</p>
<p>We already supported manual registration upgrade from the old products, but the automated way was still not adapted to the new SUSE Customer Center (SCC) API and it did not work correctly. This sprint we have adapted the registration upgrade code to correctly work in the interactive mode and also in the automatic upgrade.</p>
<p>The code was adapted to skip the user interaction and do everything manually when running in the autoupgrade mode. The only problematic part was how to handle multiple migration targets, which in the interactive upgrade we ask the user to choose one. To have a simple solution we decided to take the first migration, later (SP1) we might allow configuring this as well. But as now there is only one migration possible anyway, this looks like a good enough solution.</p>
<h2>Falling back to the guided proposal</h2>
<p>During this sprint, we were informed that AutoYaST was unable to display a proper error message when no <code>partitioning</code> section was specified and there was not enough disk space. The bug was rather easy to solve, but we wanted to take the opportunity to highlight how AutoYaST works when the <code>partitioning</code> section is missing from the profile.</p>
<p>In the past, AutoYaST implemented its own logic, different from the one used during a normal installation. Fortunately, as part of the adaptation to the new storage layer, AutoYaST relies now on the same code than the regular installation in order to propose a partitioning layout when the <code>partitioning</code> section is not specified. What is more, you can override some values which are defined in the product&#8217;s control file by setting them in the <code>general/storage</code> section from the AutoYaST profile.</p>
<h2>Leap /SLE 15 is closed, but Tumbleweed is still rolling</h2>
<p>We are really close to release Leap/SLE 15 and we are more focused on minimal changes that fix only critical stuff. On the other hand, Tumbleweed users are looking always for the latest and greatest features. In order to satisfy both groups, YaST separated Leap 15.1/SLE 15 and Tumbleweed in two different git branches. In this way, we can easily start adding new features, bug fixes and other improvements for Tumbleweed while we keep SLE15 stabilized. Besides that, there is another planned Service Pack for SLE12, and once we start to work at it, we&#8217;ll also create a new separated branch to include these changes. We also adapted all related infrastructure around the branches, such as CI, docker testing images, among others.</p>
<p>This way, we are able to allow you to enjoy the stable Leap 15 or the latest and hottest Tumbleweed.</p>
<h2>Conclusion</h2>
<p>We&#8217;re now working on our last sprint before the openSUSE Conference 2018. In two weeks we&#8217;ll come back with the highlights of Sprint 57 and until there we hope that you have already everything planned to enjoy the conference that will occur in Prague this year (we hope that you enjoy the city too). We&#8217;re looking forward to seeing you there!</p>
]]></content:encoded>
			</item>
	</channel>
</rss>
